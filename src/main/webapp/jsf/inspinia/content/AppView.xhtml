<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:f="http://xmlns.jcp.org/jsf/core" xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
      xmlns:a="http://xmlns.jcp.org/jsf/passthrough"
      xmlns:p="http://primefaces.org/ui"
      xmlns:pe="http://primefaces.org/ui/extensions">

<h:head>
    <base href="http://localhost:8080/Sors_JSFDeveloping-1.0-SNAPSHOT/"/>

    <f:metadata>
        <f:viewAction action="#{taskViewBean.init}"/>
    </f:metadata>

    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

    <title>INSPINIA | Dashboard v.3</title>

    <link href="jsf/inspinia/css/bootstrap.min.css" rel="stylesheet"/>
    <link href="jsf/inspinia/font-awesome/css/font-awesome.css" rel="stylesheet"/>

    <link href="jsf/inspinia/css/animate.css" rel="stylesheet"/>
    <link href="jsf/inspinia/css/style.css" rel="stylesheet"/>

    <!-- Mainly scripts -->
    <script src="jsf/inspinia/js/custom/websocket.js"></script>
    <script src="jsf/inspinia/js/jquery-2.1.1.js"></script>
    <script src="jsf/inspinia/js/bootstrap.min.js"></script>
    <script src="jsf/inspinia/js/plugins/metisMenu/jquery.metisMenu.js"></script>
    <script src="jsf/inspinia/js/plugins/slimscroll/jquery.slimscroll.min.js"></script>

    <!-- Flot -->
    <script src="jsf/inspinia/js/plugins/flot/jquery.flot.js"></script>
    <script src="jsf/inspinia/js/plugins/flot/jquery.flot.tooltip.min.js"></script>
    <script src="jsf/inspinia/js/plugins/flot/jquery.flot.spline.js"></script>
    <script src="jsf/inspinia/js/plugins/flot/jquery.flot.resize.js"></script>
    <script src="jsf/inspinia/js/plugins/flot/jquery.flot.pie.js"></script>
    <script src="jsf/inspinia/js/plugins/flot/jquery.flot.symbol.js"></script>
    <script src="jsf/inspinia/js/plugins/flot/curvedLines.js"></script>
    <script src="jsf/inspinia/js/LiveChartBuilder.js"></script>

    <!-- Peity -->
    <script src="jsf/inspinia/js/plugins/peity/jquery.peity.min.js"></script>
    <script src="jsf/inspinia/js/demo/peity-demo.js"></script>


    <!-- Custom and plugin javascript -->
    <script src="jsf/inspinia/js/inspinia.js"></script>
    <script src="jsf/inspinia/js/plugins/pace/pace.min.js"></script>

    <!-- jQuery UI -->
    <script src="jsf/inspinia/js/plugins/jquery-ui/jquery-ui.min.js"></script>

    <!-- Jvectormap -->
    <script src="jsf/inspinia/js/plugins/jvectormap/jquery-jvectormap-2.0.2.min.js"></script>
    <script src="jsf/inspinia/js/plugins/jvectormap/jquery-jvectormap-world-mill-en.js"></script>

    <!-- Sparkline -->
    <script src="jsf/inspinia/js/plugins/sparkline/jquery.sparkline.min.js"></script>

    <!-- Sparkline demo data  -->
    <script src="jsf/inspinia/js/demo/sparkline-demo.js"></script>

    <!-- ChartJS-->
    <script src="jsf/inspinia/js/plugins/chartJs/Chart.min.js"></script>

    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <!-- <script src="../js/plugins/chartJs/chartMaker.js"></script>  -->
    <script>
        google.charts.load('current', {packages: ['corechart']});

        function drawChart() {

            var chartData = $(".chartData").val();
            var dataModel = new google.visualization.DataTable(chartData);

            var options = {
                title: 'Payload in second',
                hAxis: {title: 'Time'},
                vAxis: {title: 'Paylaoad'},
                legend: 'none',
                width: '850',
                height: '400'
            };
            var chart = new google.visualization.LineChart(document.getElementById('sessionModalChart'));
            chart.draw(dataModel, options);
        }


        function updateEventListeners() {
            // Collapse ibox function
            $('.collapse-link').click(function () {
                var ibox = $(this).closest('div.ibox');
                var button = $(this).find('i');
                var content = ibox.find('div.ibox-content');
                content.slideToggle(200);
                button.toggleClass('fa-chevron-up').toggleClass('fa-chevron-down');
                ibox.toggleClass('').toggleClass('border-bottom');
                setTimeout(function () {
                    ibox.resize();
                    ibox.find('[id^=map-]').resize();
                }, 50);
            });

            // Close ibox function
            $('.close-link').click(function () {
                var content = $(this).closest('div.ibox');
                content.remove();
            });
        }


        function ipChangeView() {

            var contain = $('#ipExpander').hasClass('fa-chevron-up');
            if (contain) {
                $("#ipInfoBody").fadeOut('slow', function () {
                    $('#ipInfoTitle').fadeIn();
                });
                $('#ipExpander').removeClass('fa-chevron-up');
                $('#ipExpander').addClass('fa-chevron-down');
            } else {
                $('#ipInfoTitle').fadeOut('slow', function () {
                    $("#ipInfoBody").fadeIn();
                });

                $('#ipExpander').addClass('fa-chevron-up');
                $('#ipExpander').removeClass('fa-chevron-down');
            }
        }

        $(document).ready(function () {
            renderChart();

        });

        setInterval(function () {
            //   $(".updateChart").click();

            updateChart();
        }, 1000);

        function renderChart() {

            $('.line').peity('line', {height: 30, width: 100, fill: '#5791BC'});

        }

        function subnetChangeView() {

            var contain = $('#subnetExpander').hasClass('fa-chevron-up');
            if (contain) {
                $("#subnetInfoBody").fadeOut('slow', function () {
                    $('#subnetInfoTitle').fadeIn();
                });
                $('#subnetExpander').removeClass('fa-chevron-up');
                $('#subnetExpander').addClass('fa-chevron-down');
            } else {
                $('#subnetInfoTitle').fadeOut('slow', function () {
                    $("#subnetInfoBody").fadeIn();
                });

                $('#subnetExpander').addClass('fa-chevron-up');
                $('#subnetExpander').removeClass('fa-chevron-down');
            }
        }
    </script>
</h:head>
<h:body styleClass="fixed-navigation">

    <h:form id="chartData">
        <h:inputHidden id="justReceived" value="#{taskViewBean.getSelectedNetDataDownDirect()}"></h:inputHidden>
    </h:form>
    <h:inputHidden id="receivedBefore" value="0"></h:inputHidden>

    <h:inputHidden id="sessionId" value="#{taskViewBean.sessionId}"/>
    <h:form>
        <p:remoteCommand name="updateSubnetInfo"
                         update="subnetPanHeader subnetInfo selectedSubnetAddr chartData"></p:remoteCommand>
        <p:remoteCommand name="updateIpInfo" update="ipInfo ipInfoHeader"></p:remoteCommand>
        <p:remoteCommand name="updateChart" update="dataChart" oncomplete="renderChart();"></p:remoteCommand>
        <pe:remoteCommand name="setActiveCategory" actionListener="#{taskViewBean.setSelectedCat}" update="sessionList">
            <pe:methodSignature parameters="java.lang.String"/>
            <pe:methodParam name="selectedCategoryId"/>
        </pe:remoteCommand>

    </h:form>
    <!--  <h:form>

          <p:remoteCommand name="updateCategories" update="filterView:catsBlock:categoryItem" oncomplete="console.log('update catagories complete');"></p:remoteCommand>
      </h:form>
      -->

    <div id="wrapper">


        <ui:include src="LeftNavbar.xhtml"/>
        <div id="page-wrapper" class="gray-bg sidebar-content">
            <div class="row border-bottom">
                <nav class="navbar navbar-static-top" role="navigation" style="margin-bottom: 0">
                    <div class="navbar-header">
                        <a class="navbar-minimalize minimalize-styl-2 btn btn-primary "><i
                                class="fa fa-bars"></i> </a>
                        <form role="search" class="navbar-form-custom" action="../search_results.html">
                            <div class="form-group">
                                <input type="text" placeholder="Search for something..." class="form-control"
                                       name="top-search" id="top-search"/>
                            </div>
                        </form>
                    </div>
                    <ul class="nav navbar-top-links navbar-right">
                        <li>
                            <span class="m-r-sm text-muted welcome-message">Welcome to INSPINIA+ Admin Theme.</span>
                        </li>
                        <li>
                            <c:if test="#{taskViewBean.isDbManagedTask() == false}">
                                <a class="btn btn-lg btn-white btn-block"
                                   href="app/jsf/inspinia/content/Statistic.xhtml?nodeId=#{taskViewBean.nodeIdStr}&amp;taskId=#{taskViewBean.bb.bib.getId()}">Statistic</a>
                            </c:if>

                            <c:if test="#{taskViewBean.isDbManagedTask() == true}">
                                <a class="btn btn-lg btn-white btn-block"
                                   href="app/jsf/inspinia/content/Statistic.xhtml?dbid=#{taskViewBean.bb.bib.dbid}">Statistic</a>
                            </c:if>
                        </li>
                        <li>
                            <a class="btn btn-lg btn-white btn-block"
                               href="app/jsf/inspinia/content/TaskOptions.xhtml?nodeId=#{taskViewBean.nodeIdStr}&amp;taskId=#{taskViewBean.bb.bib.getId()}">Options</a>
                        </li>
                        <li class="dropdown">
                            <a class="dropdown-toggle count-info" data-toggle="dropdown" href="#">
                                <i class="fa fa-envelope"></i> <span class="label label-warning">16</span>
                            </a>
                            <ul class="dropdown-menu dropdown-messages">
                                <li>
                                    <div class="dropdown-messages-box">
                                        <a href="../profile.html" class="pull-left">
                                            <img alt="image" class="img-circle" src="../img/a7.jpg"/>
                                        </a>
                                        <div class="media-body">
                                            <small class="pull-right">46h ago</small>
                                            <strong>Mike Loreipsum</strong> started following
                                            <strong>Monica Smith</strong>. <br/>
                                            <small class="text-muted">3 days ago at 7:58 pm - 10.06.2014</small>
                                        </div>
                                    </div>
                                </li>
                                <li class="divider"/>
                                <li>
                                    <div class="dropdown-messages-box">
                                        <a href="../profile.html" class="pull-left">
                                            <img alt="image" class="img-circle" src="../img/a4.jpg"/>
                                        </a>
                                        <div class="media-body ">
                                            <small class="pull-right text-navy">5h ago</small>
                                            <strong>Chris Johnatan Overtunk</strong> started following
                                            <strong>Monica Smith</strong>. <br/>
                                            <small class="text-muted">Yesterday 1:21 pm - 11.06.2014</small>
                                        </div>
                                    </div>
                                </li>
                                <li class="divider"/>
                                <li>
                                    <div class="dropdown-messages-box">
                                        <a href="../profile.html" class="pull-left">
                                            <img alt="image" class="img-circle" src="../img/profile.jpg"/>
                                        </a>
                                        <div class="media-body ">
                                            <small class="pull-right">23h ago</small>
                                            <strong>Monica Smith</strong> love <strong>Kim Smith</strong>. <br/>
                                            <small class="text-muted">2 days ago at 2:30 am - 11.06.2014</small>
                                        </div>
                                    </div>
                                </li>
                                <li class="divider"></li>
                                <li>
                                    <div class="text-center link-block">
                                        <a href="../mailbox.html">
                                            <i class="fa fa-envelope"/> <strong>Read All Messages</strong>
                                        </a>
                                    </div>
                                </li>
                            </ul>
                        </li>
                        <li class="dropdown">
                            <a class="dropdown-toggle count-info" data-toggle="dropdown" href="#">
                                <i class="fa fa-bell"></i> <span class="label label-primary">8</span>
                            </a>
                            <ul class="dropdown-menu dropdown-alerts">
                                <li>
                                    <a href="../mailbox.html">
                                        <div>
                                            <i class="fa fa-envelope fa-fw"></i> You have 16 messages
                                            <span class="pull-right text-muted small">4 minutes ago</span>
                                        </div>
                                    </a>
                                </li>
                                <li class="divider"></li>
                                <li>
                                    <a href="../profile.html">
                                        <div>
                                            <i class="fa fa-twitter fa-fw"></i> 3 New Followers
                                            <span class="pull-right text-muted small">12 minutes ago</span>
                                        </div>
                                    </a>
                                </li>
                                <li class="divider"></li>
                                <li>
                                    <a href="../grid_options.html">
                                        <div>
                                            <i class="fa fa-upload fa-fw"></i> Server Rebooted
                                            <span class="pull-right text-muted small">4 minutes ago</span>
                                        </div>
                                    </a>
                                </li>
                                <li class="divider"></li>
                                <li>
                                    <div class="text-center link-block">
                                        <a href="../notifications.html">
                                            <strong>See All Alerts</strong>
                                            <i class="fa fa-angle-right"></i>
                                        </a>
                                    </div>
                                </li>
                            </ul>
                        </li>


                        <li>
                            <a href="../login.html">
                                <i class="fa fa-sign-out"></i> Log out
                            </a>
                        </li>
                    </ul>

                </nav>
            </div>
            <div style="margin-left: 15px;" class="row">
                <div class="col-md-4">
                    <div style="padding: 5px;" class="widget ">
                        <div class="ibox no-padding">
                            <div class="ibox-tools">
                                <a onclick="subnetChangeView();">
                                    <i id="subnetExpander" class="fa fa-chevron-up"></i>
                                </a>
                                <a class="dropdown-toggle" data-toggle="dropdown" href="#">
                                    <i class="fa fa-wrench"></i>
                                </a>
                                <ul class="dropdown-menu dropdown-user">
                                    <li><a href="#">Config option 1</a>
                                    </li>
                                    <li><a href="#">Config option 2</a>
                                    </li>
                                </ul>
                                <a class="close-link">
                                    <i class="fa fa-times"></i>
                                </a>
                            </div>
                            <div id="subnetInfoTitle" class="ibox-title" style="display: none;">
                                <h:form id="subnetPanHeader">
                                    <span class="inline col-md-4 no-padding"><h3
                                            class="text-left">#{taskViewBean.selectedSubnetAddr}</h3></span>
                                    <span class="inline col-md-1"></span>
                            <span class="text-right col-md-7 inline no-padding">

                                 <span class="text-center"
                                       style="font-weight: 600; font-size: 15px;">#{taskViewBean.getSelectedNetDataDown()}</span>
                                                <small>In</small>

                                                <span class="text-center"
                                                      style="font-weight: 600; font-size: 15px;"> #{taskViewBean.getSelectedNetDataUp()} </span>
                                                <small>Out</small>
                            </span>

                                </h:form>

                            </div>
                            <div id="subnetInfoBody" class="ibox-content" style="padding: 5px;">
                                <div class="row">
                                    <div class="col-md-5" style="padding: 10px;">
                                        <h:panelGroup id="selectedSubnetAddr">
                                            <h3 class="text-center">#{taskViewBean.selectedSubnetAddr}</h3>
                                        </h:panelGroup>

                                        <h3 class="text-center">
                                            <small> subnet</small>
                                        </h3>

                                        <div id="grapth">
                                            <div class="flot-chart clearfix">
                                                <div class="flot-chart-content" id="flot-line-chart-moving"></div>
                                            </div>
                                        </div>

                                        <h:panelGroup id="dataChart" layout="block" style="padding: 15px;">
                                            <span class="line"
                                                  style="display: none;">#{taskViewBean.getChartStrValues()}</span>
                                        </h:panelGroup>


                                    </div>
                                    <h:panelGroup layout="block" id="subnetInfo" style="float: left; padding: 5px;">
                                        <table class="table no-padding">
                                            <tbody>

                                            <tr>
                                                <td class="col-xs-4 no-top-border">
                                                    <span style="margin-top: 5px;" class="pull-right"><small>Sessions</small></span>
                                                </td>
                                                <td class="no-top-border">
                                                <span class="text-center"
                                                      style="font-weight: 600; font-size: 16px;">#{taskViewBean.getNetworkSessionsAllCount()}</span>
                                                    <small>all</small>
                                                <span class="text-center"
                                                      style="font-weight: 600; font-size: 16px;">#{taskViewBean.getNetworkSessionsActiveCount()}</span>
                                                    <small>active</small>

                                                </td>
                                            </tr>
                                            <tr>
                                                <td class="col-xs-4">
                                                    <span style="margin-top: 5px;" class="pull-right"><small>Addresses</small></span>
                                                </td>
                                                <td>
                                                <span class="text-center"
                                                      style="font-weight: 600; font-size: 16px;">#{taskViewBean.getNetworkAddrsAllCount()}</span>
                                                    <small>all</small>
                                                <span class="text-center"
                                                      style="font-weight: 600; font-size: 16px; "> #{taskViewBean.getNetworkAddrsActiveCount()}</span>
                                                    <small>active</small>

                                                </td>
                                            </tr>
                                            <tr>
                                                <td class="col-xs-4">
                                                    <span style="margin-top: 5px;" class="pull-right"><small>Traffic</small></span>
                                                </td>
                                                <td>

                                                <span class="text-center"
                                                      style="font-weight: 600; font-size: 16px;">#{taskViewBean.getSelectedNetDataDown()}</span>
                                                    <small> download</small>
                                                    <br/>
                                                <span class="text-center"
                                                      style="font-weight: 600; font-size: 16px;"> #{taskViewBean.getSelectedNetDataUp()} </span>
                                                    <small>upload</small>

                                                </td>
                                            </tr>

                                            </tbody>
                                        </table>
                                    </h:panelGroup>
                                </div>

                                <div>
                                    <ul class="list-group fa-border">

                                        <ui:repeat value="#{taskViewBean.getSubnetList()}"
                                                   var="subnetBean">
                                            <li class="list-group-item no-padding">
                                                <h:form>
                                                    <p:commandButton
                                                            styleClass="btn btn-default text-center full-width full-height"
                                                            value="#{subnetBean.subnet.getHostName()}"
                                                            action="#{taskViewBean.selectSubnet(subnetBean.getSubnet().getHostName())}"
                                                    oncomplete="initSubnetChartKb(1048576);">
                                                        <f:ajax render="subnetPanHeader subnetInfo onlineIpList allIpList"/>
                                                    </p:commandButton>
                                                </h:form>

                                            </li>
                                        </ui:repeat>


                                    </ul>

                                </div>

                            </div>


                        </div>

                    </div>
                    <div style="padding: 5px;" class="widget">
                        <div class="ibox no-padding">
                            <div class="ibox-tools">
                                <a>
                                    <i id="ipExpander" onclick="ipChangeView();" class="fa fa-chevron-up"></i>
                                </a>
                                <a class="dropdown-toggle" data-toggle="dropdown" href="#">
                                    <i class="fa fa-wrench"></i>
                                </a>
                                <ul class="dropdown-menu dropdown-user">
                                    <li><a href="#">Config option 1</a>
                                    </li>
                                    <li><a href="#">Config option 2</a>
                                    </li>
                                </ul>
                                <a class="close-link">
                                    <i class="fa fa-times"></i>
                                </a>
                            </div>
                            <div id="ipInfoTitle" class="ibox-title" style="display: none;">
                                <h:form id="ipInfoHeader">
                                    <span class="inline col-md-4"><h3>#{taskViewBean.selectedIp}</h3></span>
                                    <span class="inline col-md-1"></span>
                                    <span class="inline col-md-8 text-right"> #{taskViewBean.selectedIpDataDown} /  #{taskViewBean.selectedIpDataUp}</span>
                                </h:form>

                            </div>
                            <div id="ipInfoBody" class="ibox-content">
                                <h:panelGroup layout="block" id="ipInfo">
                                    <table class="table">
                                        <tbody>
                                        <tr>
                                            <td colspan="2" class="text-center no-top-border">

                                                <h2 class="no-padding no-margins">#{taskViewBean.selectedIp}</h2>
                                            </td>

                                        </tr>
                                        <tr>
                                            <td colspan="2" class="text-center no-top-border">
                                                <h3 class="no-padding no-margins">#{taskViewBean.ipBean.dnsName}</h3>
                                            </td>

                                        </tr>
                                        <tr>
                                            <td>
                                                <small>data down/up (kb)</small>
                                            </td>
                                            <td style="font-weight: 600;">
                                                #{taskViewBean.selectedIpDataDown} /  #{taskViewBean.selectedIpDataUp}
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <small> ses (act/all)</small>
                                            </td>
                                            <td style="font-weight: 600;">
                                                #{taskViewBean.selectedIpSesActive} / #{taskViewBean.selectedIpSesAll}
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <small> conn-s (in/out)</small>
                                            </td>
                                            <td style="font-weight: 600;">
                                                #{taskViewBean.selectedIpConIn} / #{taskViewBean.selectedIpConOut}
                                            </td>
                                        </tr>

                                        </tbody>

                                    </table>
                                </h:panelGroup>
                            </div>

                            <div class="tabs-container">

                                <ul class="nav nav-tabs">
                                    <li class="active">
                                        <a data-toggle="tab" href="#onlineIpList">Online</a>
                                    </li>
                                    <li>
                                        <a data-toggle="tab" href="#allIpList">All</a>
                                    </li>
                                </ul>
                                <div class="tab-content">


                                    <h:panelGroup id="allIpList" styleClass="tab-pane">
                                        <div style="position: relative; height: 500px; overflow: hidden;"
                                             class="slimScrollDiv">
                                            <div class="scroll_content"
                                                 style="overflow: scroll; width: auto; height: 500px;">
                                                <ul class="list-group fa-border">
                                                    <c:if test="#{taskViewBean.sb != null}">
                                                        <ui:repeat value="#{taskViewBean.allIps}"
                                                                   var="ipBean">
                                                            <li class="list-group-item no-padding">
                                                                <h:form>
                                                                    <!--<button class="text-center btn btn-default full-width full-height active">#{ipBean.ip}</button> -->

                                                                    <p:commandButton
                                                                            actionListener="#{taskViewBean.selectIp(ipBean.ip)}"
                                                                            styleClass="text-center btn btn-default full-width full-height"
                                                                            value="#{ipBean.getIp()}"
                                                                            update="ipInfo ipInfoHeader sessionList filterView"
                                                                            oncomplete="updateEventListeners();">
                                                                        <table>
                                                                            <tr>
                                                                                <td></td>
                                                                            </tr>
                                                                        </table>
                                                                    </p:commandButton>
                                                                </h:form>
                                                            </li>

                                                        </ui:repeat>
                                                    </c:if>

                                                </ul>
                                            </div>
                                        </div>

                                    </h:panelGroup>
                                    <h:panelGroup id="onlineIpList" styleClass="tab-pane active">
                                        <div style="position: relative; height: 500px; overflow: hidden;"
                                             class="slimScrollDiv">
                                            <div class="scroll_content"
                                                 style="overflow: scroll; width: auto; height: 500px;">
                                                <ul class="list-group fa-border">
                                                    <c:if test="#{taskViewBean.sb != null}">
                                                        <ui:repeat
                                                                value="#{taskViewBean.onlineIps}"
                                                                var="ipBean">
                                                            <li class="list-group-item no-padding">
                                                                <h:form>
                                                                    <p:commandLink
                                                                            actionListener="#{taskViewBean.selectIp(ipBean.ip)}"
                                                                            styleClass="text-center btn btn-default full-width full-height"
                                                                            update="ipInfo ipInfoHeader sessionList filterView"
                                                                            oncomplete="updateEventListeners();">

                                                                        <div class="col-lg-4 col-md-4 col-sm-4"
                                                                             style="font-family: Verdana; font-size: 11pt; display: inline-block; font-size: 15px;">#{ipBean.ip}</div>
                                                                        <div class="col-lg-8 col-md-8 col-sm-8"
                                                                             style="display: inline-block; text-align: right;">
                                                                            <span style="padding: 2px; color: #ebebed; background-color: #0d8ddb;">#{taskViewBean.longToStr(ipBean.dataUp)} / #{taskViewBean.longToStr(ipBean.dataDown)}</span>
                                                                            <span style="padding: 2px; color: #ebebed; background-color: #1ab394;">#{ipBean.inputCount} / #{ipBean.outputCount}</span>
                                                                            <span style="padding: 2px; color: #ebebed; background-color: #009900;">#{ipBean.activeCount}</span>
                                                                        </div>

                                                                    </p:commandLink>
                                                                </h:form>
                                                                <!--<button class="text-center btn btn-default full-width full-height active">#{ipBean.ip}</button> -->

                                                            </li>

                                                        </ui:repeat>
                                                    </c:if>

                                                </ul>
                                            </div>
                                        </div>

                                    </h:panelGroup>
                                </div>


                            </div>
                        </div>
                    </div>

                </div>

                <div class="col-md-4">
                    <div class="ibox">
                        <div class="ibox-tools">
                            <a class="collapse-link">
                                <i class="fa fa-chevron-up"></i>
                            </a>
                            <a class="dropdown-toggle" data-toggle="dropdown" href="#">
                                <i class="fa fa-wrench"></i>
                            </a>
                            <ul class="dropdown-menu dropdown-user">
                                <h:form>
                                    <li>
                                        <p:commandLink action="#{taskViewBean.addHostFilter()}"
                                                       update="filterView sessionList"
                                                       value="Add Host filter"></p:commandLink>
                                    </li>
                                    <li><p:commandLink action="#{taskViewBean.addPortFilter()}"
                                                       update="filterView sessionList"
                                                       value="Add Port filter"></p:commandLink>
                                    </li>
                                </h:form>

                            </ul>
                            <a class="close-link">
                                <i class="fa fa-times"></i>
                            </a>
                        </div>
                        <div class="ibox-content no-padding" style="background-color: inherit;">
                            <div class="ibox">

                                <div>

                                    <div class="ibox-title">
                                        <a class="collapse-link">
                                            <div class="col-md-10">
                                                Filter View
                                            </div>
                                        </a>

                                        <div class="col-md-2 switch">
                                            <div class="onoffswitch">
                                                <input type="checkbox" name="collapsemenu" checked=""
                                                       class="onoffswitch-checkbox" id="example2"/>
                                                <label class="onoffswitch-label" for="example2">
                                                    <span class="onoffswitch-inner"></span>
                                                    <span class="onoffswitch-switch"></span>
                                                </label>

                                            </div>
                                        </div>
                                    </div>

                                </div>
                                <div class="ibox-content">
                                    <h:form id="filterView">
                                        <ui:repeat id="catsBlock" value="#{taskViewBean.categories}" var="category">
                                            <div style="margin-bottom: 10px;" class="ibox no-padding fa-border row">
                                                <a class="collapse-link" ondblclick="console.log('niga');">
                                                    <div class="col-md-1 no-padding"
                                                         style="text-align: center; font-size: 20px;">
                                                        <i style="" class="fa fa-plus-square-o"></i>
                                                    </div>
                                                </a>
                                                <div class="col-md-11 ibox-title no-borders no-padding btn-default">
                                                    <a categotyId="#{taskViewBean.categories.indexOf(category)}"
                                                       onclick="setActiveCategory($(this).attr('categotyId'))">testLink</a>
                                                    <div class="" style="margin: 2px;">
                                                        <p:commandLink action="#{taskViewBean.setSelectedCat(category)}"
                                                                       update="sessionList">

                                                            <div class="" style="padding: 5px 10px 5px 10px;">
                                                                <div class="ibox no-padding no-margins">
                                                                    <div>

                                                                        <div class="col-lg-4"
                                                                             style="font-family: Verdana; font-size: 11pt; display: inline-block;">#{category.name}</div>
                                                                        <div style="text-align: right;">
                                                                            <span style="padding: 2px; color: #ebebed; background-color: #0d8ddb;">#{category.sendToStr} / #{category.receivedFromStr}</span>
                                                                            <span style="padding: 2px; color: #ebebed; background-color: #1ab394;">#{category.sesTo} / #{category.sesFrom}</span>
                                                                            <span style="padding: 2px; color: #ebebed; background-color: #009900;">#{category.activeSes}</span>
                                                                        </div>
                                                                        <div class="full-width text-right"
                                                                             style="font-family: Verdana; font-size: 11pt; display: inline-block;">#{category.categoryDesc}</div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </p:commandLink>
                                                    </div>
                                                </div>

                                                <ui:repeat value="#{category.subCategories}" var="subCat">

                                                    <div style="display: none; padding: 8px 0px 10px 12px;"
                                                         class="ibox-content gray-bg">
                                                        <div class="" style="margin: 2px;">
                                                            <p:commandLink
                                                                    actionListener="#{taskViewBean.setSelectedCat(subCat)}"
                                                                    update="sessionList">
                                                                <div class="" style="padding: 5px 10px 5px 10px;">
                                                                    <div class="ibox no-padding no-margins">
                                                                        <div>
                                                                            <div class="col-lg-4"
                                                                                 style="font-family: Verdana; font-size: 11pt; display: inline-block;">#{subCat.name}</div>
                                                                            <div style="text-align: right;">
                                                                                <span style="padding: 2px; color: #ebebed; background-color: #0d8ddb;">#{subCat.sendToStr} / #{subCat.receivedFromStr}</span>
                                                                                <span style="padding: 2px; color: #ebebed; background-color: #1ab394;">#{subCat.sesTo} / #{subCat.sesFrom}</span>
                                                                                <span style="padding: 2px; color: #ebebed; background-color: #009900;">#{subCat.activeSes}</span>
                                                                            </div>
                                                                            <div class="full-width text-right"
                                                                                 style="font-family: Verdana; font-size: 11pt; display: inline-block;">#{subCat.categoryDesc}</div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </p:commandLink>
                                                        </div>
                                                    </div>
                                                </ui:repeat>


                                            </div>

                                        </ui:repeat>
                                        <!--

                                        <ui:repeat  value="#{taskViewBean.filters}" var="smartFilter">
                                            <div class="ibox" style="height: 600px; overflow: auto;">
                                                <div >

                                                <div class="ibox-title">
                                                    <a class="collapse-link">
                                                        <div class="col-md-10">
                                                            Some filter
                                                        </div>
                                                    </a>

                                                    <div class="col-md-2 switch">
                                                        <div class="onoffswitch">
                                                            <input type="checkbox" name="collapsemenu" checked="" class="onoffswitch-checkbox" id="example2"/>
                                                            <label class="onoffswitch-label" for="example2">
                                                                <span class="onoffswitch-inner"></span>
                                                                <span class="onoffswitch-switch"></span>
                                                            </label>
                                                        </div>
                                                    </div>


                                                </div>



                                            </div>
                                                <div class="ibox-content">


                                                    <ui:repeat value="#{smartFilter.getAvailableCategories()}" var="category">
                                                        <div class="" style="margin: 2px;">
                                                            <p:commandLink actionListener="#{taskViewBean.setSelectedCat(category)}" update="filterView sessionList">
                                                                <div class="ibox-content" style="padding: 5px 10px 5px 10px;">
                                                                    <div class="ibox no-padding no-margins">
                                                                        <div>
                                                                            <div class="col-lg-4" style="font-family: Verdana; font-size: 11pt; display: inline-block;">#{category.name}</div>
                                                                            <div style="text-align: right;">
                                                                                <span style="padding: 2px; color: #ebebed; background-color: #0d8ddb;">#{category.sendToStr} / #{category.receivedFromStr}</span>
                                                                                <span style="padding: 2px; color: #ebebed; background-color: #1ab394;">#{category.sesTo} / #{category.sesFrom}</span>
                                                                                <span style="padding: 2px; color: #ebebed; background-color: #009900;">#{category.activeSes}</span>
                                                                            </div>
                                                                            <div class="full-width text-right" style="font-family: Verdana; font-size: 11pt; display: inline-block;">#{category.categoryDesc}</div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </p:commandLink>
                                                        </div>


                                                    </ui:repeat>





                                                </div>
                                            </div>
                                        </ui:repeat>
                            -->
                                    </h:form>
                                </div>
                            </div>
                        </div>

                    </div>


                </div>
                <div style="padding: 5px;" class="col-md-4 widget">
                    <div class="ibox">
                        <div class="ibox-tools">
                            <a class="collapse-link">
                                <i class="fa fa-chevron-up"></i>
                            </a>
                            <a class="dropdown-toggle" data-toggle="dropdown" href="#">
                                <i class="fa fa-wrench"></i>
                            </a>
                            <ul class="dropdown-menu dropdown-user">
                                <li><a href="#">Config option 1</a>
                                </li>
                                <li><a href="#">Config option 2</a>
                                </li>
                            </ul>
                            <a class="close-link">
                                <i class="fa fa-times"></i>
                            </a>
                        </div>
                        <div class="ibox-content">
                            <h:panelGroup layout="block" id="sessionFilterBlock" styleClass="no-margins row full-width">
                                <h:form>
                                    <div style="width: 48%; float: left;">

                                        <p:commandButton style="padding: 1px;"
                                                         styleClass="full-width no-margins  btn btn-default #{taskViewBean.sessionActiveFilter ? 'active' : ''}"
                                                         action="#{taskViewBean.changeActiveFilter()}" value="Active"
                                                         update="sessionFilterBlock sessionList"></p:commandButton>
                                        <p:commandButton style="padding: 1px;"
                                                         styleClass="full-width no-margins  btn btn-default #{taskViewBean.sessionSavedFilter ? 'active' : ''}"
                                                         action="#{taskViewBean.changeSavedFilter()}" value="Saved"
                                                         update="sessionFilterBlock sessionList"></p:commandButton>
                                    </div>
                                    <div style="width: 4%;">

                                    </div>
                                    <div style="width: 48%; float: left;">
                                        <p:commandButton style="padding: 1px;"
                                                         styleClass="full-width no-margins  btn btn-default #{taskViewBean.sessionInFilter ? 'active' : ''}"
                                                         action="#{taskViewBean.changeInFilter()}" value="Input"
                                                         update="sessionFilterBlock sessionList"></p:commandButton>
                                        <p:commandButton style="padding: 1px;"
                                                         styleClass="full-width no-margins  btn btn-default #{taskViewBean.sessionOutFilter ? 'active' : ''}"
                                                         action="#{taskViewBean.changeOutFilter()}" value="Output"
                                                         update="sessionFilterBlock sessionList"></p:commandButton>
                                    </div>
                                </h:form>

                            </h:panelGroup>
                            <hr/>
                            <h:panelGroup layout="block" id="sessionList" style="margin-top: 15px;">
                                <c:if test="#{taskViewBean.ipBean != null}">
                                    <ui:repeat value="#{taskViewBean.sessionList}" var="sessionBean">
                                        <p:commandLink action="#{taskViewBean.setSelectedSesBean(sessionBean)}"
                                                       update="sdmJsfObj chartDataForm"
                                                       oncomplete="$('#sessionDataModal').modal('toggle'); updateEventListeners();drawChart();">


                                            <div style="padding: 5px 0px 5px 0px; margin-top: 15px; border-bottom: 1px solid #ddd;">
                                                <table id="sessionViewGrid"
                                                       style=" font-size:11pt; width:100%; height: 90px;"
                                                       class="table-condensed">
                                                    <tr class="border-bottom">
                                                        <td>#{sessionBean.getEstablishedWebStr()}</td>
                                                        <td style="font-weight:bold;">#{sessionBean.getSrcIP()}</td>
                                                        <td>

                                                            <h:form rendered="#{sessionBean.isHttp()}">
                                                                <img
                                                                        style="border-radius: 7px; margin:0px; padding: 0px; width: 40px; height: 15px;"
                                                                        src="jsf/inspinia/img/http.jpg"/>

                                                            </h:form>


                                                        </td>
                                                        <td style="font-weight:bold; text-align: right;">#{sessionBean.getDstIP()}</td>
                                                    </tr>
                                                    <tr>
                                                        <td>#{sessionBean.getClosedWebStr()}</td>
                                                        <td colspan="2"> #{taskViewBean.sizeToStr(sessionBean.getSrcDataLen(),2)} / #{taskViewBean.sizeToStr(sessionBean.getDstDataLen(),2)}</td>


                                                        <td colspan="2"
                                                            style="width:100%; text-align: right;">TCP (src/dst): #{sessionBean.getSrcP()} / #{sessionBean.getDstP()}
                                                        </td>
                                                    </tr>

                                                </table>

                                            </div>
                                        </p:commandLink>
                                    </ui:repeat>

                                </c:if>
                            </h:panelGroup>


                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>


    <div id="sessionDataModal" class="modal inmodal" tabindex="-1" aria-hidden="true" role="dialog">
        <h:panelGroup id="sdmJsfObj" class="modal-dialog modal-lg" layout="block">
            <div class="modal-content animated fadeIn">
                <div class="modal-header">
                    <span style="font-size: medium;">Session Info</span>
                    <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true"></span><span
                            class="sr-only">Close</span></button>
                </div>
                <div class="modal-body">
                    <span>Session Data</span>
                    <div class="tabs-container">
                        <ul class="nav nav-tabs">
                            <li class="active"><a data-toggle="tab" href="#tabHttp">HTTP</a></li>
                            <li><a data-toggle="tab" href="#tabChart">Chart</a></li>
                            <li><a data-toggle="tab" href="#tabRaw">Raw data</a></li>
                        </ul>

                    </div>
                    <div class="tab-content">
                        <div class="tab-pane active" id="tabHttp">
                            <div class="panel-body">
                                <ui:repeat value="#{taskViewBean.selectedSesBean.httpBuf}" var="http">
                                    <ui:fragment rendered="#{http.isRequest()}">
                                        <ui:param name="httpRequest" value="#{http.castToRequest()}"/>
                                        <div class="ibox no-margins">
                                            <div class="ibox-title">
                                                <a class="collapse-link">
                                                    <div class="inline col-lg-11 no-padding">
                                                        <div class="col-md-1 no-padding"><span
                                                                style="display: inline-block; font-family: Verdana; font-size: 12pt; color: #ebebed; background-color: #0a6aa1; padding: 2px  5px  2px 5px;">#{httpRequest.getRequestMethod()}</span>
                                                        </div>
                                                        <div class="col-md-11"
                                                             style="overflow: hidden; text-overflow: ellipsis;"><p
                                                                style="display: block;"><span
                                                                style="font-size: 12pt; font-style: inherit;">#{httpRequest.getFullRequestUrl()}</span>
                                                        </p></div>

                                                    </div>
                                                </a>

                                                <div class="text-right ibox-tools inline col-lg-1">

                                                    <a class="dropdown-toggle" data-toggle="dropdown" href="#"
                                                       aria-expanded="false">
                                                        <i class="fa fa-wrench"></i>
                                                    </a>
                                                    <ul class="dropdown-menu dropdown-user">
                                                        <li><a href="#">Config option 1</a>
                                                        </li>
                                                        <li><a href="#">Config option 2</a>
                                                        </li>
                                                    </ul>

                                                </div>
                                            </div>
                                            <div class="ibox-content no-padding" style="display: none;">
                                                <div style="padding-left: 8%;">
                                                    <table class="table table-hover">
                                                        <tbody>
                                                        <ui:fragment rendered="#{httpRequest.getHost().length()>0}">
                                                            <tr>
                                                                <td class="text-center col-md-2 border-right">HOST</td>
                                                                <td>#{httpRequest.getHost()}</td>
                                                            </tr>
                                                        </ui:fragment>
                                                        <ui:fragment
                                                                rendered="#{httpRequest.getUser_Agent().length()>0}">
                                                            <tr>
                                                                <td class="text-center col-md-2 border-right">User-Agent</td>
                                                                <td>#{httpRequest.getUser_Agent()}</td>
                                                            </tr>
                                                        </ui:fragment>
                                                        <ui:fragment
                                                                rendered="#{httpRequest.getRequestVersion().length()>0}">
                                                            <tr>
                                                                <td class="text-center col-md-2 border-right">Request version</td>
                                                                <td>#{httpRequest.getRequestVersion()}</td>
                                                            </tr>
                                                        </ui:fragment>
                                                        <ui:fragment
                                                                rendered="#{httpRequest.getAccept_Charset().length()>0}">
                                                            <tr>
                                                                <td class="text-center col-md-2 border-right">Accept Charset</td>
                                                                <td>#{httpRequest.getAccept_Charset()}</td>
                                                            </tr>
                                                        </ui:fragment>
                                                        <ui:fragment
                                                                rendered="#{httpRequest.getAccept_Encoding().length()>0}">
                                                            <tr>
                                                                <td class="text-center col-md-2 border-right">Accept Encoding</td>
                                                                <td>#{httpRequest.getAccept_Encoding()}</td>
                                                            </tr>
                                                        </ui:fragment>
                                                        <ui:fragment rendered="#{httpRequest.getCookie().length()>0}">
                                                            <tr>
                                                                <td class="text-center col-md-2 border-right">Cookie</td>
                                                                <td>#{httpRequest.getCookie()}</td>
                                                            </tr>
                                                        </ui:fragment>
                                                        <ui:fragment rendered="#{httpRequest.getDate().length()>0}">
                                                            <tr>
                                                                <td class="text-center col-md-2 border-right">Date</td>
                                                                <td>#{httpRequest.getDate()}</td>
                                                            </tr>
                                                        </ui:fragment>
                                                        <ui:fragment rendered="#{httpRequest.getReferer().length()>0}">
                                                            <tr>
                                                                <td class="text-center col-md-2 border-right">Referer</td>
                                                                <td>#{httpRequest.getReferer()}</td>
                                                            </tr>
                                                        </ui:fragment>
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </div>
                                        </div>
                                    </ui:fragment>

                                    <ui:fragment rendered="#{http.isResponse()}">
                                        <ui:param name="httpResponse" value="#{http.castToResponse()}"/>
                                        <div class="ibox">
                                            <div class="ibox-title">
                                                <a class="collapse-link">
                                                    <div class="inline col-lg-11 no-padding">
                                                        <div class="col-md-1 no-padding"><span
                                                                style="display: inline-block; font-family: Verdana; font-size: 12pt; color: #ebebed; background-color: #0a6aa1; padding: 2px  5px  2px 5px;">Response</span>
                                                        </div>
                                                        <div class="col-md-11"
                                                             style="overflow: hidden; text-overflow: ellipsis;"><span
                                                                style="font-size: 12pt; font-style: inherit;">#{httpResponse.getRequestUrl()}</span>
                                                        </div>

                                                    </div>
                                                </a>

                                                <div class="text-right ibox-tools inline col-lg-1">

                                                    <a class="dropdown-toggle" data-toggle="dropdown" href="#"
                                                       aria-expanded="false">
                                                        <i class="fa fa-wrench"></i>
                                                    </a>
                                                    <ul class="dropdown-menu dropdown-user">
                                                        <li><a href="#">Config option 1</a>
                                                        </li>
                                                        <li><a href="#">Config option 2</a>
                                                        </li>
                                                    </ul>

                                                </div>
                                            </div>
                                            <div class="ibox-content no-padding" style="display: none;">
                                                <div style="padding-left: 8%;">
                                                    <table class="table table-hover">
                                                        <tbody>
                                                        <ui:fragment
                                                                rendered="#{httpResponse.getRequestVersion().length()>0}">
                                                            <tr>
                                                                <td class="text-center col-md-2 border-right">Request Ver</td>
                                                                <td>#{httpResponse.getRequestVersion()}</td>
                                                            </tr>
                                                        </ui:fragment>
                                                        <ui:fragment
                                                                rendered="#{httpResponse.getRequestUrl().length()>0}">
                                                            <tr>
                                                                <td class="text-center col-md-2 border-right">Request Url</td>
                                                                <td>#{httpResponse.getRequestUrl()}</td>
                                                            </tr>
                                                        </ui:fragment>
                                                        <ui:fragment
                                                                rendered="#{httpResponse.getResponseCode().length()>0}">
                                                            <tr>
                                                                <td class="text-center col-md-2 border-right">Response Code</td>
                                                                <td>#{httpResponse.getResponseCode()}</td>
                                                            </tr>
                                                        </ui:fragment>
                                                        <ui:fragment rendered="#{httpResponse.getServer().length()>0}">

                                                            <tr>
                                                                <td class="text-center col-md-2 border-right">Server</td>
                                                                <td>#{httpResponse.getServer()}</td>
                                                            </tr>
                                                        </ui:fragment>
                                                        <ui:fragment
                                                                rendered="#{httpResponse.getSet_Cookie().length()>0}">

                                                            <tr>
                                                                <td class="text-center col-md-2 border-right">Set_Cookie</td>
                                                                <td>#{httpResponse.getSet_Cookie()}</td>
                                                            </tr>
                                                        </ui:fragment>
                                                        <ui:fragment
                                                                rendered="#{httpResponse.getAccept_Ranges().length()>0}">
                                                            <tr>
                                                                <td class="text-center col-md-2 border-right">Accept_Ranges</td>
                                                                <td>#{httpResponse.getAccept_Ranges()}</td>
                                                            </tr>
                                                        </ui:fragment>
                                                        <ui:fragment
                                                                rendered="#{httpResponse.getContent_Encoding().length()>0}">

                                                            <tr>
                                                                <td class="text-center col-md-2 border-right">Content_Encoding</td>
                                                                <td>#{httpResponse.getContent_Encoding()}</td>
                                                            </tr>
                                                        </ui:fragment>
                                                        <ui:fragment
                                                                rendered="#{httpResponse.getContent_Length().length()>0}">
                                                            <tr>
                                                                <td class="text-center col-md-2 border-right">Content_Length</td>
                                                                <td>#{httpResponse.getContent_Length()}</td>
                                                            </tr>
                                                        </ui:fragment>
                                                        <ui:fragment
                                                                rendered="#{httpResponse.getContent_Type().length()>0}">

                                                            <tr>
                                                                <td class="text-center col-md-2 border-right">Content_Type</td>
                                                                <td>#{httpResponse.getContent_Type()}</td>
                                                            </tr>
                                                        </ui:fragment>


                                                        </tbody>
                                                    </table>
                                                </div>
                                            </div>
                                        </div>
                                    </ui:fragment>

                                </ui:repeat>
                            </div>
                        </div>
                        <div class="tab-pane" id="tabChart">
                            <div class="panel-body">
                                <div id="sessionModalChart" class="full-width full-height">

                                </div>
                            </div>
                        </div>
                        <div class="tab-pane" id="tabRaw">
                            <div class="panel-body">

                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </h:panelGroup>
    </div>

    <h:form id="chartDataForm">
        <h:inputText style="display: none;" styleClass="chartData" value="#{taskViewBean.chartDataStr}"></h:inputText>
    </h:form>

</h:body>
</html>