<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
      xmlns:a="http://xmlns.jcp.org/jsf/passthrough"
      xmlns:p="http://primefaces.org/ui"
      xmlns:pe="http://primefaces.org/ui/extensions">
<h:head>
    <base href="http://localhost:8080/Sors_JSFDeveloping-1.0-SNAPSHOT/"/>

    <f:metadata>
        <f:viewAction action="#{taskViewBean.init}"/>
    </f:metadata>


    <title>INSPINIA | Dashboard v.3</title>

    <link href="jsf/inspinia/css/bootstrap.min.css" rel="stylesheet"/>
    <link href="jsf/inspinia/font-awesome/css/font-awesome.css" rel="stylesheet"/>
    <link href="jsf/inspinia/css/plugins/footable/footable.core.css" rel="stylesheet"/>

    <link href="jsf/inspinia/css/animate.css" rel="stylesheet"/>
    <link href="jsf/inspinia/css/style.css" rel="stylesheet"/>


    <link href="jsf/inspinia/css/AppView.css" rel="stylesheet"/>
    <script src="jsf/inspinia/js/clipboard.min.js" type="text/javascript"></script>
    <script type="text/javascript">
        var clipboard = new Clipboard('.copyButton');
        clipboard.on('success', function (e) {
            console.log(e);
        });
        clipboard.on('error', function (e) {
            console.log(e);
        });
    </script>

    <!-- Mainly scripts -->
    <script src="jsf/inspinia/js/bootstrap.min.js" type="text/javascript"></script>
    <script src="jsf/inspinia/js/plugins/metisMenu/jquery.metisMenu.js" type="text/javascript"></script>
    <script src="jsf/inspinia/js/plugins/slimscroll/jquery.slimscroll.min.js" type="text/javascript"></script>

    <!-- Peity -->
    <script src="jsf/inspinia/js/plugins/peity/jquery.peity.min.js" type="text/javascript"></script>
    <script src="jsf/inspinia/js/demo/peity-demo.js" type="text/javascript"></script>


    <!-- Custom and plugin javascript -->
    <script src="jsf/inspinia/js/inspinia.js" type="text/javascript"></script>
    <script src="jsf/inspinia/js/plugins/pace/pace.min.js" type="text/javascript"></script>

    <!-- jQuery UI -->
    <script src="jsf/inspinia/js/plugins/jquery-ui/jquery-ui.min.js" type="text/javascript"></script>

    <!-- Jvectormap -->
    <script src="jsf/inspinia/js/plugins/jvectormap/jquery-jvectormap-2.0.2.min.js" type="text/javascript"></script>
    <script src="jsf/inspinia/js/plugins/jvectormap/jquery-jvectormap-world-mill-en.js" type="text/javascript"></script>

    <!-- Sparkline -->
    <script src="jsf/inspinia/js/plugins/sparkline/jquery.sparkline.min.js" type="text/javascript"></script>

    <!-- Sparkline demo data  -->
    <script src="jsf/inspinia/js/demo/sparkline-demo.js" type="text/javascript"></script>

    <!-- ChartJS-->
    <script src="jsf/inspinia/js/plugins/chartJs/Chart.min.js" type="text/javascript"></script>
</h:head>
<h:body styleClass="top-navigation">
    <h:inputHidden id="sessionId" value="#{taskViewBean.sessionId}"/>
    <h:form>
        <p:remoteCommand name="updateSubnetInfo"
                         update="subnetPanHeader subnetInfo selectedSubnetAddr"></p:remoteCommand>
        <p:remoteCommand name="updateIpInfo" update="ipInfo ipInfoHeader"></p:remoteCommand>
        <pe:remoteCommand name="setActiveCategory" actionListener="#{taskViewBean.setSelectedCat}" update="sessionList">
            <pe:methodSignature parameters="java.lang.String"/>
            <pe:methodParam name="selectedCategoryId"/>
        </pe:remoteCommand>

    </h:form>


    <div id="wrapper">

        <div id="page-wrapper" class="gray-bg">

            <ui:include src="MenuTop.xhtml"/>

            <div id="visiblePart" class="row">
                <div class=" col-md-3 widget no-padding">
                    <div class="ibox mb10">
                        <div class="ibox-tools">
                            <a id="subnetExpander">
                                <i class="fa fa-chevron-up"></i>
                            </a>
                            <a class="dropdown-toggle" data-toggle="dropdown" href="#">
                                <i class="fa fa-wrench"></i>
                            </a>
                            <ul class="dropdown-menu dropdown-user">
                                <li><a href="#">Config option 1</a>
                                </li>
                                <li><a href="#">Config option 2</a>
                                </li>
                            </ul>
                            <a class="close-link">
                                <i class="fa fa-times"></i>
                            </a>
                        </div>
                        <div style="background-color: #e6e6e6;" id="subnetInfoTitle" class="ibox-title border_1 clearfix">
                            <h:form id="subnetPanHeader">
                                <div>
                                    <span class="col-md-4 text-left large_ip">#{taskViewBean.selectedSubnetAddr}</span>
                                    <div class="text-right col-md-4 col-md-offset-4">
                                        <div class="ip_in_out">
                                            <span class="text-center large_numbers">#{taskViewBean.getSelectedNetDataDown()}</span>
                                            <small> In</small>
                                        </div>
                                        <div>
                                            <span class="text-center large_numbers"> #{taskViewBean.getSelectedNetDataUp()} </span>
                                            <small> Out</small>
                                        </div>
                                    </div>
                                </div>
                            </h:form>
                        </div>

                        <div id="subnetInfoBody" class="ibox-content clearfix">
                            <div class="row">
                                <div class="col-lg-12 col-sm-12 smallerColPadding">
                                    <div class="form-group">
                                        <div style="background-color: #e6e6e6;"
                                             class="select_ip">                    <!-- jubaka -->
                                            <h:panelGroup id="selectedSubnetAddr">
                                                <span>#{taskViewBean.selectedSubnetAddr}</span>
                                            </h:panelGroup>

                                            <button id="showSelect"
                                                    class="select_ip__button btn btn-default btn-circle">
                                                <i class="fa fa-caret-down"></i>
                                            </button>
                                        </div>
                                    </div>
                                    <div id="subnetList" class="full-width">
                                        <h:form>
                                            <ui:repeat value="#{taskViewBean.getSubnetList()}" var="subnetBean">
                                                <p:commandButton
                                                        styleClass="block full-width btn btn-default select_ip__value"
                                                        value="#{subnetBean.subnet.getHostName()}"
                                                        action="#{taskViewBean.selectSubnet(subnetBean.getSubnet().getHostName())}"
                                                        update="selectedSubnetAddr subnetPanHeader subnetInfo filterView">

                                                </p:commandButton>
                                            </ui:repeat>
                                        </h:form>
                                        <hr class="no-margins"/>
                                        <div class="full-width">
                                            <h:form>
                                                <p:inputText style="width: 50%"
                                                             value="#{taskViewBean.netAddr}"></p:inputText>
                                                /
                                                <p:inputText style="width: 20%"
                                                             value="#{taskViewBean.mask}"></p:inputText>
                                                <p:commandButton style="width: 25%;" styleClass="btn btn-primary"
                                                                 action="#{taskViewBean.addNetwork()}"
                                                                 value="add NET"></p:commandButton>
                                            </h:form>

                                        </div>
                                    </div>
                                    <h:panelGroup id="subnetInfo">
                                        <table class="table no-padding">
                                            <tbody>
                                            <tr>
                                                <td class="no-top-border">
                                                    <span class="pull-right"><small>Sessions</small></span>
                                                </td>
                                                <td class="no-top-border">
                                                    <span class="text-center large_numbers">#{taskViewBean.getNetworkSessionsAllCount()}</span>
                                                    <small>all</small>
                                                    <span class="text-center large_numbers">#{taskViewBean.getNetworkSessionsActiveCount()}</span>
                                                    <small>active</small>

                                                </td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <span class="pull-right"><small>Addresses</small></span>
                                                </td>
                                                <td>
                                                    <span class="text-center large_numbers">#{taskViewBean.getNetworkAddrsAllCount()}</span>
                                                    <small>all</small>
                                                    <span class="text-center large_numbers"> #{taskViewBean.getNetworkAddrsActiveCount()}</span>
                                                    <small>active</small>

                                                </td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <span class="pull-right"><small>Traffic</small></span>
                                                </td>
                                                <td>

                                                    <span class="text-center large_numbers">#{taskViewBean.getSelectedNetDataDown()}</span>
                                                    <small> download</small>
                                                    <br/>
                                                    <span class="text-center large_numbers"> #{taskViewBean.getSelectedNetDataUp()}  </span>
                                                    <small> upload</small>

                                                </td>
                                            </tr>

                                            </tbody>
                                        </table>
                                    </h:panelGroup>

                                </div>

                            </div>

                        </div>
                    </div>
                    <h:panelGroup layout="block" id="filterView">

                        <div class="tabs-container ibox-content no-padding">

                            <ul class="nav nav-tabs">
                                <li class="active">
                                    <a data-toggle="tab" href="#onlineIpList">Online</a>
                                </li>
                                <li>
                                    <a data-toggle="tab" href="#allIpList">All</a>
                                </li>
                            </ul>
                            <div class="tab-content">
                                <div id="onlineIpList" class="tab-pane active">

                                    <ul class="list-group fa-border">

                                        <c:if test="#{taskViewBean.sb != null}">
                                            <ui:repeat value="#{taskViewBean.onlineIps}"
                                                       var="ipBean">
                                                <li class="list-group-item no-padding">
                                                    <h:form>
                                                        <p:commandLink
                                                                actionListener="#{taskViewBean.selectIp(ipBean.ip)}"
                                                                styleClass="text-center btn btn-default full-width full-height"
                                                                update="ipInfo ipInfoHeader sessionList jsf_filterView"
                                                                oncomplete="updateEventListeners(); buildFoo();">
                                                            <span class="filter_button_ip pull-left">#{ipBean.getIp()}</span>                <!-- pull-left jubaka -->
                                                            <div class="filter_ip_info_clors pull-right">
                                                                <span>#{taskViewBean.longToStr(ipBean.dataUp)} / #{taskViewBean.longToStr(ipBean.dataDown)}</span>
                                                                <span>#{ipBean.inputCount} / #{ipBean.outputCount}</span>
                                                                <span>#{ipBean.activeCount}</span>
                                                            </div>
                                                        </p:commandLink>
                                                    </h:form>
                                                </li>
                                            </ui:repeat>

                                        </c:if>


                                    </ul>

                                </div>

                                <div id="allIpList" class="tab-pane">


                                    <ul class="list-group fa-border">
                                        <c:if test="#{taskViewBean.sb != null}">
                                            <ui:repeat value="#{taskViewBean.allIps}"
                                                       var="ipBean">
                                                <li class="list-group-item no-padding">
                                                    <h:form>
                                                        <p:commandLink
                                                                actionListener="#{taskViewBean.selectIp(ipBean.ip)}"
                                                                styleClass="text-center btn btn-default full-width full-height"
                                                                update="ipInfo ipInfoHeader sessionList jsf_filterView"
                                                                oncomplete="updateEventListeners(); buildFoo();">
                                                            <span class="filter_button_ip pull-left">#{ipBean.getIp()}</span>                <!-- pull-left jubaka -->
                                                            <div class="filter_ip_info_clors pull-right">
                                                                <span>#{taskViewBean.longToStr(ipBean.dataUp)} / #{taskViewBean.longToStr(ipBean.dataDown)}</span>
                                                                <span>#{ipBean.inputCount} / #{ipBean.outputCount}</span>
                                                                <span>#{ipBean.activeCount}</span>
                                                            </div>
                                                        </p:commandLink>
                                                    </h:form>
                                                </li>
                                            </ui:repeat>

                                        </c:if>


                                    </ul>

                                </div>


                            </div>

                        </div>

                    </h:panelGroup>

                </div>

                <div class="col-md-3">                                  <!-- jubaka -->

                    <div class="ibox widget mb10">
                        <div id="blockBofore">
                            <iframe name="frame_visiblePart" id="frame_visiblePart"></iframe>
                            <div class="ibox-tools">
                                <a id="ipExpander">
                                    <i class="fa fa-chevron-up"></i>
                                </a>
                                <a class="dropdown-toggle" data-toggle="dropdown" href="#">
                                    <i class="fa fa-wrench"></i>
                                </a>
                                <ul class="dropdown-menu dropdown-user">
                                    <li><a href="#">Config option 1</a>
                                    </li>
                                    <li><a href="#">Config option 2</a>
                                    </li>
                                </ul>
                                <a class="close-link">
                                    <i class="fa fa-times"></i>
                                </a>
                            </div>
                            <div style="background-color: #e6e6e6;" id="ipInfoTitle" class="ibox-title border_1 clearfix">
                                <h:form id="ipInfoHeader">
                                    <span class="col-md-7 large_ip">#{taskViewBean.selectedIp}</span>
                                    <span class="col-md-5 smal text-right ipInfo_title_in_out">
                                    <span class="large_numbers"> #{taskViewBean.selectedIpDataDown} /  #{taskViewBean.selectedIpDataUp}</span>
                                </span>
                                </h:form>
                            </div>
                            <div id="ipInfoBody" class="ibox-content">
                                <h:panelGroup layout="block" styleClass="row" id="ipInfo">
                                    <div class="col-md-12 smallerColPadding">
                                        <div style="background-color: #e6e6e6;" class="text-center ip_and_adress">
                                            <h2 class="no-padding no-margins large_ip">#{taskViewBean.selectedIp}</h2>
                                            <h3 class="no-padding no-margins large_numbers">#{taskViewBean.ipBean.dnsName}</h3>
                                        </div>
                                        <div>
                                            <table class="table info_body__table_nochart">
                                                <tbody>
                                                <tr>
                                                    <td class="no-top-border">
                                                    <span class="pull-right">                   <!-- jubaka -->
                                                        <small>data down/up (kb)</small>
                                                    </span>

                                                    </td>
                                                    <td class="no-top-border">

                                                        #{taskViewBean.selectedIpDataDown} /  #{taskViewBean.selectedIpDataUp}
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>
                                                    <span class="pull-right">                   <!-- jubaka -->
                                                        <small> ses (act/svd)  </small>
                                                    </span>

                                                    </td>
                                                    <td>
                                                        #{taskViewBean.selectedIpSesActive} / #{taskViewBean.selectedIpSesAll}
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>
                                                    <span class="pull-right">                   <!-- jubaka -->
                                                        <small> conn-s (in/out) </small>
                                                    </span>

                                                    </td>
                                                    <td>
                                                        #{taskViewBean.selectedIpConIn} / #{taskViewBean.selectedIpConOut}
                                                    </td>
                                                </tr>

                                                </tbody>
                                            </table>
                                        </div>


                                    </div>
                                </h:panelGroup>


                                <h:panelGroup style="height: 35px;" layout="block" id="sessionFilterBlock"
                                              styleClass="row col-md-12 col-sm-12 col-lg-12">

                                    <div class="col-md-6 col-sm-6 no-padding inline" data-toggle="buttons">
                                        <h:form>
                                            <p:commandLink action="#{taskViewBean.changeActiveFilter()}"
                                                           update="sessionFilterBlock sessionList"
                                                           styleClass="btn btn-default #{taskViewBean.sessionActiveFilter ? 'active' : ''}"
                                                           oncomplete="buildFoo();"
                                                           style="width: 50%;">
                                                Active
                                            </p:commandLink>
                                            <p:commandLink action="#{taskViewBean.changeSavedFilter()}"
                                                           update="sessionFilterBlock sessionList"
                                                           styleClass="btn btn-default #{taskViewBean.sessionSavedFilter ? 'active' : ''}"
                                                           oncomplete="buildFoo();"
                                                           style="width: 50%;">
                                                Saved
                                            </p:commandLink>
                                        </h:form>
                                    </div>
                                    <div class="col-md-6 col-sm-6 no-padding inline" data-toggle="buttons">
                                        <h:form>
                                            <p:commandLink action="#{taskViewBean.changeInFilter()}"
                                                           update="sessionFilterBlock sessionList"
                                                           styleClass="btn btn-default #{taskViewBean.sessionInFilter ? 'active' : ''}"
                                                           oncomplete="buildFoo();"
                                                           style="width: 50%;">
                                                Input
                                            </p:commandLink>
                                            <p:commandLink action="#{taskViewBean.changeOutFilter()}"
                                                           update="sessionFilterBlock sessionList"
                                                           styleClass="btn btn-default #{taskViewBean.sessionOutFilter ? 'active' : ''}"
                                                           oncomplete="buildFoo();"
                                                           style="width: 50%;">
                                                Output
                                            </p:commandLink>
                                        </h:form>
                                    </div>

                                </h:panelGroup>

                            </div>

                        </div>
                    </div>


                    <div class="ibox">
                        <div class="ibox-tools">
                            <a id="sort_ip_collapse">
                                <i class="fa fa-chevron-up"></i>
                            </a>
                            <a class="dropdown-toggle" data-toggle="dropdown" href="#">
                                <i class="fa fa-wrench"></i>
                            </a>
                            <ul class="dropdown-menu dropdown-user">
                                <li><a href="#">Config option 1</a>
                                </li>
                                <li><a href="#">Config option 2</a>
                                </li>
                            </ul>
                            <a class="close-link">
                                <i class="fa fa-times"></i>
                            </a>
                        </div>
                        <div id="sort_ip_body_collapse" class="ibox-content sort_ip">
                            <div class="title_sort">
                                <span>Сортировать по:</span>
                                <div class="btn-group mb10" data-toggle="buttons">
                                    <h:form id="sessionFilterbtns">
                                        <p:commandLink
                                                styleClass="btn btn-default buttons_sort #{taskViewBean.isHostCategorised() ? 'active' : ''}"
                                                action="#{taskViewBean.setHostPortCategorised()}"
                                                update="jsf_filterView sessionFilterbtns"
                                                oncomplete="updateEventListeners(); buildFoo();">
                                            Хостам
                                        </p:commandLink>
                                        <p:commandLink
                                                styleClass="btn btn-default buttons_sort #{taskViewBean.isPortCategorised() ? 'active' : ''}"
                                                action="#{taskViewBean.setPortHostCategorised()}"
                                                update="jsf_filterView sessionFilterbtns"
                                                oncomplete="updateEventListeners(); buildFoo();">
                                            Портам
                                        </p:commandLink>
                                    </h:form>

                                </div>
                                <div class="input-group search_ip__form">
                                    <input type="text" class="form-control" placeholder="Search"/>
                                    <div class="input-group-addon to_search_ip">
                                        <button class="btn btn-default fa fa-search"></button>
                                    </div>
                                </div>
                            </div>

                            <div id="filterViewDirect" class="ibox no-margins">
                                <div class="ibox-content no-padding" style="overflow: auto;">

                                    <h:form id="jsf_filterView">
                                        <ui:repeat id="catsBlock" value="#{taskViewBean.categories}" var="category">

                                            <div style="margin-bottom: 10px;" class="ibox no-padding fa-border">
                                                <a class="collapse-link">
                                                    <div class="col-md-1 no-padding"
                                                         style="text-align: center; font-size: 20px;">
                                                        <i class="fa fa-plus-square-o"></i>
                                                    </div>
                                                </a>
                                                <p:commandLink action="#{taskViewBean.setSelectedCat(category)}"
                                                               update="sessionList" oncomplete="buildFoo();">

                                                    <div style="padding: 2px;"
                                                         class="col-md-11 ibox-title no-borders no-padding btn-default">
                                                        <div class="filter_view">
                                                            <span class="filter_button_ip">#{category.name}</span>
                                                            <div class="filter_ip_info_clors">
                                                                <span>#{category.sendToStr} / #{category.receivedFromStr}</span>
                                                                <span>#{category.sesTo} / #{category.sesFrom}</span>

                                                            </div>
                                                            <div class="full-width text-right filter_view__site"
                                                                 style="">#{category.categoryDesc}.com
                                                            </div>
                                                        </div>
                                                    </div>

                                                </p:commandLink>


                                                <ui:repeat value="#{category.subCategories}" var="subCat">

                                                    <div style="display: none;" class="ibox-content gray-bg no-padding">
                                                        <p:commandLink styleClass="ibox filter_view__dDown_info"
                                                                       actionListener="#{taskViewBean.setSelectedCat(subCat)}"
                                                                       update="sessionList" oncomplete="buildFoo();">

                                                            <div class="filter_view">
                                                                <span class="filter_button_ip">#{subCat.name}</span>
                                                                <div class="filter_ip_info_clors">
                                                                    <span>#{subCat.sendToStr} / #{subCat.receivedFromStr}</span>
                                                                    <span>#{subCat.sesTo} / #{subCat.sesFrom}</span>

                                                                </div>
                                                                <div class="full-width text-right filter_view__site"
                                                                     style="">#{subCat.categoryDesc}</div>
                                                            </div>
                                                        </p:commandLink>
                                                    </div>
                                                </ui:repeat>

                                            </div>

                                        </ui:repeat>


                                    </h:form>

                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <h:panelGroup id="sessionList" styleClass="col-md-6 widget no-padding full-height">
                    <div class="ibox no-margins full-height">
                        <div class="ibox-tools">
                            <a class="collapse-link">
                                <i class="fa fa-chevron-up"></i>
                            </a>
                            <a class="dropdown-toggle" data-toggle="dropdown" href="#">
                                <i class="fa fa-wrench"></i>
                            </a>
                            <ul class="dropdown-menu dropdown-user">
                                <li><a href="#">Config option 1</a>
                                </li>
                                <li><a href="#">Config option 2</a>
                                </li>
                            </ul>
                            <a class="close-link">
                                <i class="fa fa-times"></i>
                            </a>
                        </div>

                        <div id="box_with_buttons" class="ibox-content vertical_center smallerColPadding">

                            <div class="row">
                                <div class="col-sm-6 col-md-6 border-bottom pull-left">
                                    <h:form>
                                        <p:commandLink styleClass="btn btn-default pull-right"
                                                       action="#{taskViewBean.setSessionViewMode()}" value="Session mode"
                                                       update="ses_http_view" oncomplete="buildFoo();"></p:commandLink>
                                        <p:commandLink styleClass="btn btn-default pull-right"
                                                       action="#{taskViewBean.setHttpViewMode()}" value="HTTP mode"
                                                       update="ses_http_view" oncomplete="buildFoo();"></p:commandLink>
                                    </h:form>
                                </div>
                                <div class="col-sm-6 col-md-6 pull-right">

                                    <div class="input-group"><input  id="searchIn" onkeyup="mySearchFunc()" type="text" class="form-control"></input>
                                        <span class="input-group-btn">
                                    <button type="button" class="btn btn-default">
                                        <span class="fa fa-search"></span>
                                    </button>
                                </span>
                                    </div>
                                </div>

                            </div>



                            <h:panelGroup id="ses_http_view" layout="block" styleClass="full-width">

                                <c:if test="#{taskViewBean.isSessionViewMode()}">
                                    <c:if test="#{taskViewBean.isHostCategorised()}">
                                        <table  id="fooTable" class="footable table table-stripped toggle-arrow-tiny"
                                               data-page-size="11">
                                            <thead>
                                            <tr>
                                                <th data-toggle="true">Time start</th>
                                                <th>Time end</th>
                                                <th>Src port</th>
                                                <th>Dst port</th>
                                                <th>Src data</th>
                                                <th>Dst data</th>
                                                <th>HTTP</th>
                                                <th data-hide="all">SRC host</th>
                                                <th data-hide="all">DST host</th>
                                                <th data-hide="all">Duration</th>
                                                <th data-hide="all"></th>
                                            </tr>
                                            </thead>
                                            <tbody>

                                            <c:if test="#{taskViewBean.ipBean != null}">
                                                <ui:repeat value="#{taskViewBean.sessionList}" var="sessionBean">
                                                    <tr>
                                                        <td>
                                                            #{sessionBean.getEstablishedWebStr()}
                                                        </td>
                                                        <td>
                                                            #{sessionBean.getClosedWebStr()}
                                                        </td>
                                                        <td>
                                                            #{sessionBean.getSrcP()}
                                                        </td>
                                                        <td>
                                                            #{sessionBean.getDstP()} (???)
                                                        </td>
                                                        <td>
                                                            #{taskViewBean.sizeToStr(sessionBean.getSrcDataLen(),2)}
                                                        </td>
                                                        <td>
                                                            #{taskViewBean.sizeToStr(sessionBean.getDstDataLen(),2)}
                                                        </td>
                                                        <td>#{sessionBean.httpBuf.size()}</td>
                                                        <td>
                                                            #{sessionBean.getSrcIP()}  Dns: #{taskViewBean.getDnsNameIfNotEquals(sessionBean.getSrcIP())}
                                                        </td>
                                                        <td>
                                                            #{sessionBean.getDstIP()} Dns: #{taskViewBean.getDnsNameIfNotEquals(sessionBean.getDstIP())}
                                                        </td>
                                                        <td>
                                                            <div class="full-width">5 sec
                                                                <button class="btn btn-default pull-right">Info</button>
                                                            </div>
                                                        </td>
                                                        <td></td>

                                                    </tr>
                                                </ui:repeat>
                                            </c:if>
                                            </tbody>
                                            <tfoot>
                                            <tr>
                                                <td colspan="7">
                                                    <ul class="pagination pull-right"></ul>
                                                </td>
                                            </tr>
                                            </tfoot>
                                        </table>
                                    </c:if>

                                    <c:if test="#{taskViewBean.isPortCategorised()}">

                                        <table id="fooTable" class="footable table table-stripped toggle-arrow-tiny"
                                               data-page-size="11">
                                            <thead>
                                            <tr>
                                                <th data-toggle="true">Time start</th>
                                                <th>Time end</th>
                                                <th>SRC host</th>
                                                <th>DST host</th>
                                                <th>Src data</th>
                                                <th>Dst data</th>
                                                <th>HTTP</th>

                                                <th data-hide="all">Src port</th>
                                                <th data-hide="all">Dst port</th>
                                                <th data-hide="all">SRC host</th>
                                                <th data-hide="all">DST host</th>
                                                <th data-hide="all">Duration</th>
                                                <th data-hide="all"></th>
                                            </tr>
                                            </thead>
                                            <tbody>

                                            <c:if test="#{taskViewBean.ipBean != null}">
                                                <ui:repeat value="#{taskViewBean.sessionList}" var="sessionBean">
                                                    <tr>
                                                        <td>
                                                            #{sessionBean.getEstablishedWebStr()}
                                                        </td>
                                                        <td>
                                                            #{sessionBean.getClosedWebStr()}
                                                        </td>

                                                        <td>
                                                            #{sessionBean.getSrcIP()}
                                                        </td>
                                                        <td>
                                                            #{sessionBean.getDstIP()}
                                                        </td>

                                                        <td>
                                                            #{taskViewBean.sizeToStr(sessionBean.getSrcDataLen(),2)}
                                                        </td>
                                                        <td>
                                                            #{taskViewBean.sizeToStr(sessionBean.getDstDataLen(),2)}
                                                        </td>
                                                        <td>#{sessionBean.httpBuf.size()}</td>

                                                        <td>
                                                            #{sessionBean.getSrcP()} (???)
                                                        </td>
                                                        <td>
                                                            #{sessionBean.getDstP()} (???)
                                                        </td>

                                                        <td>
                                                            #{sessionBean.getSrcIP()}  Dns: #{taskViewBean.getDnsNameIfNotEquals(sessionBean.getSrcIP())}
                                                        </td>
                                                        <td>
                                                            #{sessionBean.getDstIP()}  Dns: #{taskViewBean.getDnsNameIfNotEquals(sessionBean.getDstIP())}
                                                        </td>
                                                        <td>
                                                            <div class="full-width">5 sec
                                                                <button class="btn btn-default pull-right">Info</button>
                                                            </div>
                                                        </td>
                                                        <td></td>

                                                    </tr>
                                                </ui:repeat>
                                            </c:if>
                                            </tbody>
                                            <tfoot>
                                            <tr>
                                                <td colspan="7">
                                                    <ul class="pagination pull-right"></ul>
                                                </td>
                                            </tr>
                                            </tfoot>
                                        </table>
                                    </c:if>

                                </c:if>

                                <c:if test="#{taskViewBean.isHttpViewMode()}">
                                    <table id="http_foo_view" class="footable table table-stripped toggle-arrow-tiny inline col-md-12 no-padding"
                                           data-page-size="11">
                                        <thead class="inline col-md-12 no-padding">
                                        <tr class="inline col-md-12 no-padding">
                                            <th class="col-md-1 inline no-borders" data-toggle="true">Type</th>
                                            <th class="col-md-6 inline no-borders">Resource</th>
                                            <th class="col-md-4 inline no-borders">User-Agent</th>
                                            <th data-hide="all"></th>
                                            <th data-hide="all"></th>
                                            <th data-hide="all"></th>
                                            <th data-hide="all"></th>
                                            <th data-hide="all"></th>
                                            <th data-hide="all"></th>
                                            <th data-hide="all"></th>
                                            <th data-hide="all"></th>
                                            <th data-hide="all"></th>
                                            <th data-hide="all"></th>
                                            <th data-hide="all"></th>
                                        </tr>

                                        </thead>
                                        <tbody class="inline col-md-12 no-padding">
                                        <ui:repeat value="#{taskViewBean.httpList}" var="http">
                                            <ui:fragment rendered="#{http.isRequest()}">
                                                <c:set var="httpRequest" value="#{http.castToRequest()}"></c:set>
                                                <tr class="inline col-md-12 no-padding">
                                                    <td style="padding: 8px;"
                                                        class="col-md-1 inline">#{httpRequest.getRequestMethod()}</td>
                                                    <td style="padding: 8px;" class="col-md-6 inline">
                                                        <div style="overflow: hidden; text-overflow: ellipsis;"><span
                                                                style="white-space: nowrap;">#{httpRequest.getFullRequestUrl()}</span>
                                                        </div>
                                                    </td>
                                                    <td style="padding: 8px;" class="col-md-4 inline">
                                                        <div style="overflow: hidden; text-overflow: ellipsis;"><span
                                                                style="white-space: nowrap;">#{httpRequest.getUser_Agent()} </span>
                                                        </div>
                                                    </td>
                                                    <ui:fragment rendered="#{httpRequest.getHost().length()>0}">
                                                    <td><span style="white-space: nowrap;"><span
                                                            class="httpHeader">Host: </span>#{httpRequest.getHost()} </span>
                                                    </td>
                                                    </ui:fragment>
                                                    <ui:fragment rendered="#{httpRequest.getUser_Agent().length()>0}">
                                                    <td><span style="white-space: nowrap;"><span
                                                            class="httpHeader">User-Agent: </span>#{httpRequest.getUser_Agent()}</span>
                                                    </td>
                                                    </ui:fragment>
                                                    <ui:fragment rendered="#{httpRequest.getRequestVersion().length()>0}">
                                                    <td><span style="white-space: nowrap;"><span
                                                            class="httpHeader">RequestVersion: </span>#{httpRequest.getRequestVersion()}</span>
                                                    </td>
                                                    </ui:fragment>
                                                    <ui:fragment rendered="#{httpRequest.getAccept_Charset().length()>0}">
                                                        <td>
                                                            <span style="white-space: nowrap;"><span
                                                                    class="httpHeader">Accept_Charset: </span>#{httpRequest.getAccept_Charset()}</span>
                                                        </td>
                                                    </ui:fragment>
                                                    <ui:fragment
                                                            rendered="#{httpRequest.getAccept_Encoding().length()>0}">
                                                        <td>
                                                            <span style="white-space: nowrap;"><span
                                                                    class="httpHeader">Accept_Encoding: </span>#{httpRequest.getAccept_Encoding()}</span>
                                                        </td>
                                                    </ui:fragment>
                                                    <ui:fragment rendered="#{httpRequest.getCookie().length()>0}">
                                                    <td><span style="white-space: nowrap;"><span
                                                            class="httpHeader">Cookie: </span>#{httpRequest.getCookie()}</span>
                                                    </td>
                                                    </ui:fragment>
                                                    <ui:fragment rendered="#{httpRequest.getDate().length()>0}">
                                                        <td><span style="white-space: nowrap;"><span
                                                                class="httpHeader">Date: </span>#{httpRequest.getDate()}</span>
                                                        </td>
                                                    </ui:fragment>
                                                    <ui:fragment rendered="#{httpRequest.getReferer().length()>0}">
                                                    <td><span style="white-space: nowrap;"><span
                                                            class="httpHeader">Referer: </span>#{httpRequest.getReferer()}</span>
                                                    </td>
                                                    </ui:fragment>

                                                    <ui:fragment rendered="#{httpRequest.getAccept_Ranges().length()>0}">
                                                        <td><span style="white-space: nowrap;"><span
                                                                class="httpHeader">Accept_Ranges: </span>#{httpRequest.getAccept_Ranges()}</span>
                                                        </td>
                                                    </ui:fragment>

                                                    <ui:fragment rendered="#{httpRequest.getAuthorization().length()>0}">
                                                        <td><span style="white-space: nowrap;"><span
                                                                class="httpHeader">Authorization: </span>#{httpRequest.getAuthorization()}</span>
                                                        </td>
                                                    </ui:fragment>

                                                    <ui:fragment rendered="#{httpRequest.getCache_Control().length()>0}">
                                                        <td><span style="white-space: nowrap;"><span
                                                                class="httpHeader">Cache_Control: </span>#{httpRequest.getCache_Control()}</span>
                                                        </td>
                                                    </ui:fragment>

                                                    <ui:fragment rendered="#{httpRequest.getConnection().length()>0}">
                                                        <td><span style="white-space: nowrap;"><span
                                                                class="httpHeader">Connection: </span>#{httpRequest.getConnection()}</span>
                                                        </td>
                                                    </ui:fragment>

                                                    <ui:fragment rendered="#{httpRequest.getContent_Length().length()>0}">
                                                        <td><span style="white-space: nowrap;"><span
                                                                class="httpHeader">Content_Length: </span>#{httpRequest.getContent_Length()}</span>
                                                        </td>
                                                    </ui:fragment>

                                                    <ui:fragment rendered="#{httpRequest.getContent_Type().length()>0}">
                                                        <td><span style="white-space: nowrap;"><span
                                                                class="httpHeader">Content_Type: </span>#{httpRequest.getContent_Type()}</span>
                                                        </td>
                                                    </ui:fragment>

                                                    <ui:fragment rendered="#{httpRequest.getIf_Modified_Since().length()>0}">
                                                        <td><span style="white-space: nowrap;"><span
                                                                class="httpHeader">If_Modified_Since: </span>#{httpRequest.getIf_Modified_Since()}</span>
                                                        </td>
                                                    </ui:fragment>

                                                    <ui:fragment rendered="#{httpRequest.getIf_None_Match().length()>0}">
                                                        <td><span style="white-space: nowrap;"><span
                                                                class="httpHeader">If_None_Match: </span>#{httpRequest.getIf_None_Match()}</span>
                                                        </td>
                                                    </ui:fragment>

                                                    <ui:fragment rendered="#{httpRequest.getProxy_Connection().length()>0}">
                                                        <td><span style="white-space: nowrap;"><span
                                                                class="httpHeader">Proxy_Connection: </span>#{httpRequest.getProxy_Connection()}</span>
                                                        </td>
                                                    </ui:fragment>

                                                    <ui:fragment rendered="#{httpRequest.getRequestMethod().length()>0}">
                                                        <td><span style="white-space: nowrap;"><span
                                                                class="httpHeader">RequestMethod: </span>#{httpRequest.getRequestMethod()}</span>
                                                        </td>
                                                    </ui:fragment>

                                                    <ui:fragment rendered="#{httpRequest.getRequestUrl().length()>0}">
                                                        <td><span style="white-space: nowrap;"><span
                                                                class="httpHeader">RequestUrl: </span>#{httpRequest.getRequestUrl()}</span>
                                                        </td>
                                                    </ui:fragment>

                                                    <ui:fragment rendered="#{httpRequest.getUA_CPU().length()>0}">
                                                        <td><span style="white-space: nowrap;"><span
                                                                class="httpHeader">UA_CPU: </span>#{httpRequest.getUA_CPU()}</span>
                                                        </td>
                                                    </ui:fragment>

                                                </tr>
                                            </ui:fragment>
                                            <ui:fragment rendered="#{http.isResponse()}">
                                                <c:set var="httpResponse" value="#{http.castToResponse()}"></c:set>
                                                    <tr class="inline col-md-12 no-padding">
                                                        <td style="padding: 8px;"
                                                            class="col-md-1 inline">RESP</td>
                                                        <td style="padding: 8px;" class="col-md-4 inline">
                                                            <div style="overflow: hidden; text-overflow: ellipsis;"><span
                                                                    style="white-space: nowrap;">#{httpResponse.getResponseCode()}</span>
                                                            </div>
                                                        </td>
                                                        <td style="padding: 8px;" class="col-md-6 inline">
                                                            <div style="overflow: hidden; text-overflow: ellipsis;"><span
                                                                    style="white-space: nowrap;">#{httpResponse.getRequestUrl()} </span>
                                                            </div>
                                                        </td>

                                                        <ui:fragment rendered="#{httpResponse.getAccept_Ranges().length()>0}">
                                                            <td><span style="white-space: nowrap;"><span
                                                                    class="httpHeader">Accept_Ranges: </span>#{httpResponse.getAccept_Ranges()}</span>
                                                            </td>
                                                        </ui:fragment>
                                                        <ui:fragment rendered="#{httpResponse.getAge().length()>0}">
                                                            <td><span style="white-space: nowrap;"><span
                                                                    class="httpHeader">Age: </span>#{httpResponse.getAge()}</span>
                                                            </td>
                                                        </ui:fragment>

                                                        <ui:fragment rendered="#{httpResponse.getAllow().length()>0}">
                                                            <td><span style="white-space: nowrap;"><span
                                                                    class="httpHeader">Allow: </span>#{httpResponse.getAllow()}</span>
                                                            </td>
                                                        </ui:fragment>

                                                        <ui:fragment rendered="#{httpResponse.getCache_Control().length()>0}">
                                                            <td><span style="white-space: nowrap;"><span
                                                                    class="httpHeader">Cache_Control: </span>#{httpResponse.getCache_Control()}</span>
                                                            </td>
                                                        </ui:fragment>

                                                        <ui:fragment rendered="#{httpResponse.getContent_Disposition().length()>0}">
                                                            <td><span style="white-space: nowrap;"><span
                                                                    class="httpHeader">Content_Disposition: </span>#{httpResponse.getContent_Disposition()}</span>
                                                            </td>
                                                        </ui:fragment>

                                                        <ui:fragment rendered="#{httpResponse.getContent_Encoding().length()>0}">
                                                            <td><span style="white-space: nowrap;"><span
                                                                    class="httpHeader">Content_Encoding: </span>#{httpResponse.getContent_Encoding()}</span>
                                                            </td>
                                                        </ui:fragment>

                                                        <ui:fragment rendered="#{httpResponse.getContent_Length().length()>0}">
                                                            <td><span style="white-space: nowrap;"><span
                                                                    class="httpHeader">Content_Length: </span>#{httpResponse.getContent_Length()}</span>
                                                            </td>
                                                        </ui:fragment>

                                                        <ui:fragment rendered="#{httpResponse.getContent_Location().length()>0}">
                                                            <td><span style="white-space: nowrap;"><span
                                                                    class="httpHeader">Content_Location: </span>#{httpResponse.getContent_Location()}</span>
                                                            </td>
                                                        </ui:fragment>

                                                        <ui:fragment rendered="#{httpResponse.getContent_MD5().length()>0}">
                                                            <td><span style="white-space: nowrap;"><span
                                                                    class="httpHeader">Content_MD5: </span>#{httpResponse.getContent_MD5()}</span>
                                                            </td>
                                                        </ui:fragment>

                                                        <ui:fragment rendered="#{httpResponse.getContent_Range().length()>0}">
                                                            <td><span style="white-space: nowrap;"><span
                                                                    class="httpHeader">Content_Range: </span>#{httpResponse.getContent_Range()}</span>
                                                            </td>
                                                        </ui:fragment>

                                                        <ui:fragment rendered="#{httpResponse.getContent_Type().length()>0}">
                                                            <td><span style="white-space: nowrap;"><span
                                                                    class="httpHeader">Content_Type: </span>#{httpResponse.getContent_Type()}</span>
                                                            </td>
                                                        </ui:fragment>

                                                        <ui:fragment rendered="#{httpResponse.getExpires().length()>0}">
                                                            <td><span style="white-space: nowrap;"><span
                                                                    class="httpHeader">Expires: </span>#{httpResponse.getExpires()}</span>
                                                            </td>
                                                        </ui:fragment>

                                                        <ui:fragment rendered="#{httpResponse.getRequestUrl().length()>0}">
                                                            <td><span style="white-space: nowrap;"><span
                                                                    class="httpHeader">RequestUrl: </span>#{httpResponse.getRequestUrl()}</span>
                                                            </td>
                                                        </ui:fragment>

                                                        <ui:fragment rendered="#{httpResponse.getRequestVersion().length()>0}">
                                                            <td><span style="white-space: nowrap;"><span
                                                                    class="httpHeader">RequestVersion: </span>#{httpResponse.getRequestVersion()}</span>
                                                            </td>
                                                        </ui:fragment>

                                                        <ui:fragment rendered="#{httpResponse.getResponseCode().length()>0}">
                                                            <td><span style="white-space: nowrap;"><span
                                                                    class="httpHeader">ResponseCode: </span>#{httpResponse.getResponseCode()}</span>
                                                            </td>
                                                        </ui:fragment>

                                                        <ui:fragment rendered="#{httpResponse.getResponseCodeMsg().length()>0}">
                                                            <td><span style="white-space: nowrap;"><span
                                                                    class="httpHeader">ResponseCodeMsg: </span>#{httpResponse.getResponseCodeMsg()}</span>
                                                            </td>
                                                        </ui:fragment>

                                                        <ui:fragment rendered="#{httpResponse.getServer().length()>0}">
                                                            <td><span style="white-space: nowrap;"><span
                                                                    class="httpHeader">Server: </span>#{httpResponse.getServer()}</span>
                                                            </td>
                                                        </ui:fragment>

                                                        <ui:fragment rendered="#{httpResponse.getSet_Cookie().length()>0}">
                                                            <td><span style="white-space: nowrap;"><span
                                                                    class="httpHeader">Set_Cookie: </span>#{httpResponse.getSet_Cookie()}</span>
                                                            </td>
                                                        </ui:fragment>
                                                    </tr>

                                            </ui:fragment>
                                        </ui:repeat>

                                        </tbody>
                                        <tfoot>
                                        <tr>
                                            <td colspan="7">
                                                <ul class="pagination pull-right"></ul>
                                            </td>
                                        </tr>
                                        </tfoot>
                                    </table>

                                </c:if>


                            </h:panelGroup>


                        </div>

                    </div>
                </h:panelGroup>

            </div>

        </div>
    </div>


    <div id="sessionDataModal" class="modal inmodal" tabindex="-1" aria-hidden="true" role="dialog">
        <div class="modal-dialog modal-lg">
            <div class="modal-content animated fadeIn">
                <div class="modal-header">
                    <span style="font-size: medium;">Session Info</span>
                    <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&amp;times;</span><span
                            class="sr-only">Close</span></button>
                </div>
                <div class="modal-body">
                    <span>Session Data</span>
                    <div class="tabs-container">
                        <ul class="nav nav-tabs">
                            <li class="active"><a data-toggle="tab" href="#tabHttp">HTTP</a></li>
                            <li><a data-toggle="tab" href="#tabChart" onmouseup="drawChart();">Chart</a></li>
                            <li><a data-toggle="tab" href="#tabRaw">Raw data</a></li>
                        </ul>

                    </div>
                    <div class="tab-content">
                        <div class="tab-pane active" id="tabHttp">
                            <div class="panel-body">
                                <div class="ibox clearfix">
                                    <div class="ibox-title">
                                        <a class="collapse-link">
                                            <div class="inline col-lg-11 no-padding">
                                                <div class="col-md-1 no-padding"><span
                                                        style="display: inline-block; font-family: Verdana; font-size: 12pt; color: #ebebed; background-color: #0a6aa1; padding: 2px  5px  2px 5px;">GET</span>
                                                </div>
                                                <div id="content" class="col-md-11"
                                                     style="overflow: hidden; text-overflow: ellipsis;"><span
                                                        style="font-size: 12pt; font-style: inherit; ">binupdate.mail.ru/updater/version.xmlfgfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff </span>
                                                </div>

                                            </div>
                                        </a>
                                        <div class="text-right ibox-tools inline col-lg-1">

                                            <a id="copy-button" data-clipboard-target="#content"
                                               class="copy-text dropdown-toggle">
                                                <i class="fa fa-wrench"></i>
                                            </a>

                                        </div>


                                    </div>
                                    <table class="table table-hover modal__table">
                                        <tbody>
                                        <tr>
                                            <td class="text-center border-right">HOST</td>
                                            <td>amazon.comnmazonamazonamazonamaznamazonamaznamazonamazonamazonamdfdfdfdfdfdfdfdfdfdfdfddfazonamazonamazonamazonamazon amazonamazonamazon</td>
                                        </tr>
                                        <tr>
                                            <td class="text-center border-right">HOST</td>
                                            <td style="overflow: auto;">amazon.com</td>
                                        </tr>
                                        <tr>
                                            <td class="text-center border-right">HOST</td>
                                            <td>amazon.com</td>
                                        </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                        <div class="tab-pane" id="tabChart">
                            <div class="panel-body">
                                <div id="sessionModalChart" class="full-width full-height"></div>

                            </div>
                        </div>
                        <div class="tab-pane" id="tabRaw">
                            <div id="sessionChart" class="panel-body">

                            </div>
                        </div>

                    </div>

                </div>
            </div>

        </div>

    </div>

    <script src="jsf/inspinia/js/plugins/slimscroll/jquery.slimscroll.min.js"></script>
    <script src="jsf/inspinia/js/plugins/footable/footable.all.min.js"></script>
    <script src="jsf/inspinia/js/AppView.js"></script>
    <script src="jsf/inspinia/js/plugins/pace/pace.min.js"></script>

    <script>
        $(document).ready(function () {
            buildFoo();
        });
        function buildFoo() {
            $('.footable').footable();
        }

    </script>

</h:body>
</html>